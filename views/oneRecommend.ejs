<!doctype html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">


    <link href="/css/header.css" rel="stylesheet" type="text/css" />
    <link href="/css/article.css" rel="stylesheet" type="text/css" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="/imgs/logo.ico" type="image/x-icon" />

    <title>æ–‡è—å¯Œå¿ƒ</title>
</head>

<body>
   <!-- navbar -->
   <div id="header"></div>

    <!-- ä½¿ç”¨è€…ç™¼æ–‡ -->
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-lg-8 content shadow">
                <div class="info d-flex">
                    <div><a class="floorTag">æ¨“ä¸»</a></div>
                    <div>
                        <a>å¯Œå¿ƒæ¼¢ğŸ‘¨ğŸ¿â€ğŸ”§</a>
                        <a class="next"></a>
                        <a class="dateTime">æ–¼<%= items[0][0].recomDateTime %>ç™¼ä½ˆ</a>
                    </div>
                </div>
                <hr  style="margin-top: 0.5em"/>

                <h5><%= items[0][0].recomHead %></h5>
                <hr />

                <p class="content"> <%- items[0][0].recomCont %>
                </p>

                <!-- tag -->
                <div class="tagDiv col-lg-12 ">
                    <% if(items[2] != undefined) { %>
                        <% for (var i = 0 ; i< items[2].length ; i++) { %>
                            <button type="button" class="btn  tag"><%= items[2][i].tagName %></button>
                        <% } %>
                    <% } %>
                </div>

                <hr class="info">
                <!-- info -->
                <div class="info">
                    <!-- æ„›å¿ƒæŒ‰éˆ• -->
                    <button type="button" id="LikeUnLogIn" class="btn postInfo" style="display:none" 
                            onclick="location.href='/login'"> <i class="fab fa-gratipay"></i><a>
                            <%= items[0][0].likeCount %></a></button>
                    <button type="button" id="addLike" class="btn postInfo" style="display:none" 
                        onclick=<%= "addLike(" + items[0][0].recomNum + ")" %>> <i class="fab fa-gratipay"></i><a
                            id="addLikeCount"> <%= items[0][0].likeCount %> </a></button>
                    <button type="button" id="delLike" class="btn postInfo" style="display: none"
                        onclick=<%= "delLike(" + items[0][0].recomNum + ")" %>><i class="fab fa-gratipay" style="color:#c93737;"></i><a
                            id="delLikeCount"><%= items[0][0].likeCount %></a></button>
                    <!-- å¦‚æœæ²’ç™»å…¥ -->
                    <% if(items[8][0] == undefined) {%>
                    <script type="text/javascript">
                        document.getElementById("LikeUnLogIn").style.display = "inline";
                        document.getElementById("addLike").style.display = "none";
                        document.getElementById("delLike").style.display = "none";
                    </script>

                    <!-- å¦‚æœæœ‰ç™»å…¥åŠæ²’æŒ‰éæ„›å¿ƒ -->
                    <% }else if(items[4][0] == undefined && items[8][0] != undefined ) {%>
                    <script type="text/javascript">
                        document.getElementById("addLike").style.display = "inline";
                        document.getElementById("LikeUnLogIn").style.display = "none";
                        document.getElementById("delLike").style.display = "none";
                    </script>
                    <!-- å¦‚æœæœ‰ç™»å…¥åŠæŒ‰éæ„›å¿ƒ -->
                    <% }else if(items[4][0] != undefined && items[8][0] != undefined) {%>
                    <script type="text/javascript">
                        document.getElementById("delLike").style.display = "inline";
                        document.getElementById("addLike").style.display = "none";
                        document.getElementById("LikeUnLogIn").style.display = "none";
                    </script>
                    <% } %>

                    <!-- ç•™è¨€æ•¸é‡æŒ‰éˆ• -->
                    <button type="button" class="btn postInfo" id="goBottom"><i
                            class="fas fa-comment-dots"></i><a><%= items[0][0].messCount %></a></button>

                    <!-- æ”¶è—æŒ‰éˆ• -->
                    <button type="button" id="unLogIn" class="btn postInfo" style="display:none" 
                        onclick="location.href='/login'">
                        <i class="far fa-bookmark"></i></button>

                    <button type="button" id="addColle" class="btn postInfo" style="display:none"
                        onclick=<%= "addColle(" + items[0][0].recomNum + ")" %>>
                        <i class="far fa-bookmark"></i></button>

                    <button type="button" id="delColle" class="btn postInfo" style="display:none"
                        onclick=<%= "delColle(" + items[0][0].recomNum + ")" %>>
                        <i class="fas fa-bookmark"></i></button>

                    <!-- å¦‚æœæ²’ç™»å…¥ -->
                    <% if(items[8][0] == undefined) {%>
                    <script type="text/javascript">
                        document.getElementById("unLogIn").style.display = "inline";
                        document.getElementById("addColle").style.display = "none";
                        document.getElementById("delColle").style.display = "none";
                    </script>

                    <!-- å¦‚æœæœ‰ç™»å…¥åŠæ²’æŒ‰éæ”¶è—       -->
                    <% }else if(items[5][0] == undefined && items[8][0] != undefined ) {%>
                    <script type="text/javascript">
                        document.getElementById("addColle").style.display = "inline";
                        document.getElementById("unLogIn").style.display = "none";
                        document.getElementById("delColle").style.display = "none";
                    </script>
                    <!-- å¦‚æœæœ‰ç™»å…¥åŠæŒ‰éæ”¶è— -->
                    <% }else if(items[5][0] != undefined && items[8][0] != undefined ) {%>
                    <script type="text/javascript">
                        document.getElementById("delColle").style.display = "inline";
                        document.getElementById("addColle").style.display = "none";
                        document.getElementById("unLogIn").style.display = "none";
                    </script>
                    <% } %>
                </div>
            </div>
            <!-- infoçµæŸ -->
        </div>
    <!-- ä½¿ç”¨è€…ç™¼æ–‡çµæŸ' -->
    <div class="row justify-content-center">
            <div class="preferLi content shadow col-lg-8 justify-content-center">
                <h5 style="color: rgb(83, 83, 83);text-align: left !important;">ä½ å¯èƒ½æœƒå–œæ­¡çš„æ–‡ç« </h5>
                <hr class="smallMagin">
                <ul class="liContainer" style="text-align: left !important;">
                    <% for(var j = 0 ; j<items[10].length ; j++) { %>
                        <li><a href="/oneRecommend/<%= items[10][j].recomNum %>"><%= items[10][j].recomNum %></a>
                        </li>
                    <% } %>
                </ul>
            </div>
        </div>

    <center>
        <h1>æ–‡ç« ç•™è¨€</h1>
        <hr class="separate">
    </center>

    <!-- æ–‡ç« ç•™è¨€ -->

    <div class="row justify-content-center">
        <% for(var i = 0 ; i < items[1].length ; i ++){ %>
        <div class="col-lg-8 content shadow">
            <!-- æ–‡ç« ç•™è¨€ -->
            <div class="message">
                <!-- info -->
                <div class="info d-flex justify-content-between">
                    <div><a class="floorTag"><%= i+1 %> æ¨“</a></div>
                    <div><a class="name"><%= items[1][i].memID %></a>
                        <a class="next"></a>
                        <a class="dateTime">æ–¼<%= items[1][i].recomMessDateTime %>ç•™è¨€</a>
                    </div>
                    <!-- æ„›å¿ƒæŒ‰éˆ• -->
                    <div class="col-sm-1 ml-auto likeContainer"> 
                        <button type="button" id=<%= "MessLikeUnLogIn" + items[0][0].recomNum + items[1][i].recomMessNum %>
                                class="btn like" style="display:none" onclick="location.href='/login'"><i
                        class="fab fa-gratipay"></i><a><%= items[1][i].likeCount %></a>
                        </button>
                        <button type="button" id=<%= "MessAddLike"+ items[0][0].recomNum + items[1][i].recomMessNum %>
                            class="btn like" style="display:none"
                            onclick=<%= "MessAddLike(" + items[0][0].recomNum + "," + items[1][i].recomMessNum + ")" %>>
                            <i class="fab fa-gratipay"></i>
                            <a id=<%="MessAddLikeCount" + items[0][0].recomNum + items[1][i].recomMessNum %>>
                                <%= items[1][i].likeCount %>
                            </a>
                        </button>
    
                        <button type="button" id=<%= "MessDelLike" + items[0][0].recomNum + items[1][i].recomMessNum %>
                            class="btn like"  style="display:none"
                            onclick=<%= "MessDelLike(" + items[0][0].recomNum + "," + items[1][i].recomMessNum + ")" %>>
                            <i class="fab fa-gratipay" style="color:#c93737"></i>
                            <a id=<%= "MessDelLikeCount" + items[0][0].recomNum + items[1][i].recomMessNum %>>
                                <%= items[1][i].likeCount %></a>
                        </button>
                    </div>
                </div>
                <hr class="smallMagin">

                    <!-- å¦‚æœæ²’ç™»å…¥ -->
                    <% if(items[8][0] == undefined) {%>
                    <script type="text/javascript">
                        document.getElementById("MessLikeUnLogIn" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "inline";
                        document.getElementById("MessAddLike" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "none";
                        document.getElementById("MessDelLike" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "none";
                    </script>
                    <!-- å¦‚æœæœ‰ç™»å…¥ -->
                    <% }else if(items[8][0] != undefined ) {%>
                        <% var isLike = false %>
                        <% if(items[6] != undefined){ %>
                            <% for(var j = 0 ; j < items[6].length ; j++) { %>
                                 <!-- å¦‚æœæœ‰æŒ‰æ„›å¿ƒ -->
                                 <% if (items[6][j].recomMessNum == items[1][i].recomMessNum){ %>
                                    <script type="text/javascript">
                                        document.getElementById("MessDelLike" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "inline";
                                        document.getElementById("MessAddLike" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "none";
                                        document.getElementById("MessLikeUnLogIn" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "none";
                                    </script>
                                    <% isLike = true %>
                                <% } %>
                            <% } %>
                        <% } %>
                        <!-- å¦‚æœæ²’æœ‰æŒ‰éæ„›å¿ƒ -->
                        <% if( isLike == false ){ %> 
                            <script type="text/javascript">
                                document.getElementById("MessAddLike" + "<%= items[0][0].recomNum %>" + "<%=  items[1][i].recomMessNum %>").style.display = "inline";
                                document.getElementById("MessLikeUnLogIn" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "none";
                                document.getElementById("MessDelLike" + "<%= items[0][0].recomNum %>" + "<%= items[1][i].recomMessNum %>").style.display = "none";
                            </script>
                        <% } %>
                    <% } %>
                <!-- infoçµæŸ -->

                <p class="content"> <%- items[1][i].recomMessCont %> </p>
                <hr>
                <% if(items[8][0] != items[1][i].memID) {%>
                    <button type="button" class="btn report" id="postReport" data-toggle="modal" data-target="#recomMessReportPost" >æª¢èˆ‰</button>
                <% } else { %>
                  <!-- å¦‚æœç•™è¨€æ˜¯ä»–è‡ªå·±çš„å°±ä¸é¡¯ç¤ºæª¢èˆ‰ é¡¯ç¤ºä¸‹é¢å°±å¥½ -->   
                <div class="dropdown ml-auto float-right dropup">
                        <button class="btn btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-ellipsis-h"></i>     
                        </button>
                        <div class="dropdown-menu dotMenu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="/editRecommendReply/<%= items[1][i].recomMessNum %>">ç·¨è¼¯</a>
                            <a class="dropdown-item" href="#/" onclick="deleteReply('<%- items[1][i].recomMessNum %>', '<%- items[1][i].memID %>')">åˆªé™¤</a>
                        </div>
                    </div>
                <% } %>
             </div>

        </div>

        <!-- æ¨è–¦ç•™è¨€æª¢èˆ‰å€å¡Š -->
        <div class="modal fade" id="recomMessReportPost" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalCenterTitle">æª¢èˆ‰</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <form>
                        <div class="modal-body" style="padding:1em;">
                            <textarea class="report" name="reportReason" id="messReportReason" placeholder="è¼¸å…¥æª¢èˆ‰åŸå› "></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" id="messReport"  class="btn btn-danger" onclick=<%= "ftn_messReport(" + items[1][i].recomMessNum + ")" %>>æäº¤</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <% } %>
        </div>
        <!-- æ¨è–¦ç•™è¨€çµæŸ -->
        



    <!-- replying -->
    <div class="row replying justify-content-center" id="reply" spellcheck="false">
        <div class="col-lg-8 content shadow">
            <div class="replyInput" id="replyInput" contenteditable="true" role="textbox" data-text="è«‹è¼¸å…¥å›è¦†å…§å®¹"></div>
            <label class="btn btn-dark col-lg-2" style="cursor: pointer">

                <input id="file-selector" type="file" multiple="multiple" accept=".jpg,.png,.gif,.tif,.bmp" />
                <i class="fas fa-images" style="padding-right:5px"></i>åŠ åœ–ç‰‡

            </label>

            <button type="submit" class="btn btn-danger float-right submitReplyButton col-lg-2"
            onclick=<%= "submitReply(" + items[0][0].recomNum + ")" %>>æäº¤å›è¦†</button>
        </div>
    </div>
    <!-- replying end -->
</div>

    <a href="#" id="gotop">
        <i class="fa fa-angle-up"></i>
    </a>

    <div class="spinner-border" role="status" style="position: fixed; top: 45%; left: 50%; margin-left:-20px; display: none;">
            <span class="sr-only">Loading...</span>
     </div>



    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js "
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo "
        crossorigin="anonymous "></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js "
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1 "
        crossorigin="anonymous "></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM "
        crossorigin="anonymous "></script>
    <script src="/javascripts/active.js "></script>
    <script src="/javascripts/post.js "></script>
    <script src="/javascripts/navbar.js"></script>
    <script>
        var member = '<%=items[8][0]%>'
            $('#replyInput').focus(() => {
                if (!member) {
                    alert('è«‹é€²è¡Œç™»å…¥å†ç•™è¨€ï¼')
                    location.replace("/logIn");

                }
            })
            Array.from($('.liContainer').find('li > a')).map((item) => {
                item.innerText = item.innerText.length > 15 ? `${item.innerText.substring(0,15)}...` : item.innerText
            })
            var imgs = [];
            var formData = new FormData(); //ç”¨formDataä¾†å­˜å–è¦å‚³é€çš„æ‰€æœ‰è³‡æ–™
            // é¸å–åˆ°æª”æ¡ˆå¾Œé–‹å§‹å‹•ä½œ
            $('#file-selector').change(function(event) {
                let timeStamp = new Date().getTime()
                var file = $("#file-selector")[0];  //å–å¾—æª”æ¡ˆ
                //å¦‚æœæœ‰æª”æ¡ˆå°±è¦åŠ å…¥formData
                if (file.files.length) {
                    Object.keys(file.files).map((img, index) => {
                        file.files[img].timeStamp = `${timeStamp}${index}`
                        imgs.push(file.files[img])
                        // è§£ææª”æ¡ˆ
                        var item = file.files[img]
                        var reader = new FileReader();
                        reader.onload = (function(item) {
                            return function(event) {
                                var src = event.target.result // åœ–ç‰‡çš„ç·¨ç¢¼ , æ ¼å¼ç‚ºbase64
                                var title = escape(file.name);
                                var img = '<img class="upload-img" src="' + src + '" title="' + title + '" key="' + `${timeStamp}${index}` + '"/> ';
                                console.log($(this))
                                $('#replyInput').append('<div id="replyInput">' + img + '</div>');
                            };
                        })(file);
                        reader.readAsDataURL(item);
                    })
                    $('#file-selector').val('')
                }
            });
            function submitReply(artiNum) {
                $('.submitReplyButton').addClass('disabled')
                $('.submitReplyButton').attr('disabled', true)
                $('.spinner-border').css('display', 'block')
    
                var imgKey = []
                if ($("#replyInput").find("#replyInput > img")) {
                    Array.from($("#replyInput").find("#replyInput > img")).map((img) => {
                        imgKey.push(img.getAttribute('key'))
                    })
                    imgs.map((img) => {
                        if (imgKey.indexOf(img.timeStamp) >= 0) {
                            formData.append('userImg', img);
                        }
                    })
                    Array.from($("#replyInput").find("#replyInput > img")).forEach((img) => {
                        $(img).before("\\:imgLocation")
                    })
                }
                formData.append('artiNum', artiNum);
                var replyCont = [];
                var replyData = document.querySelectorAll("div.replyInput"); //åªå–å¾—æ–‡å­—éƒ¨åˆ†(ä¸å«åœ–ç‰‡) ;
                // å–å¾—å…§å®¹
                replyData.forEach(function (element) {
                    replyCont.push(element.innerText);
                }, this);
                formData.append('replyCont', replyCont);
                $.ajax({
                    url: 'https://analyze405.herokuapp.com/sentimentAnalyze/',
                    type: 'POST',
                    dataType: 'TEXT',
                    data: { 'artiCont': `${replyCont}` },
                    success: function (res) {
                        var analyzeRes = JSON.parse(res)
                        var analyzeScore = analyzeRes.analyze[0]
                        var positiveWords = analyzeRes.analyze[1]
                        var negativeWords = analyzeRes.analyze[2]
                        var swearWords = analyzeRes.analyze[3]
                        console.log(analyzeScore, positiveWords, negativeWords, swearWords)
                        formData.append('analyzeScore', analyzeScore);
                        formData.append('positiveWords', positiveWords);
                        formData.append('negativeWords', negativeWords);
                        formData.append('swearWords', swearWords);
                        $.ajax({
                            url: '/recommend/reply',
                            type: 'POST',
                            dataType: 'TEXT',
                            data: formData,
                            processData: false,
                            contentType: false,
                            success: function (res) {
                                if (res == "è«‹é€²è¡Œç™»å…¥") {
                                    alert(res);
                                    location.replace("/logIn");
                                } else if (res == "ç•™è¨€æˆåŠŸ") {
                                    alert(res);
                                    location.reload();
                                } else {
                                    alert('å“å‘€ï¼Œå‡ºç¾éŒ¯èª¤')
                                }
                            },
                            error: function (res) {
                                console.log("å“å‘€ï¼Œå‡ºç¾éŒ¯èª¤", res);
                            }
                        });
                    },
                    error: function (res) {
                        console.error(res)
                    }
                });
            }
        </script>
        <!-- æ”¶è— ajax script  -->
        <script>
                //æ–°å¢æ”¶è—
                function addColle(recomNum) {
                    collection();
                    $.ajax({
                        url: '/addCollection',
                        type: 'POST',
                        dataType: 'JSON',
                        data: { "likeType": "recommend", "recomNum": recomNum },
                        success: function (res) {
                            console.log("yes", JSON.stringify(res));
                        },
                        error: function (res) {
                            console.log("å¤±æ•—", JSON.stringify(res));
                        }
                    });
                };
                //åˆªé™¤æ”¶è—
                function delColle(recomNum) {
                    cancelCollection();
                    $.ajax({
                        url: '/delCollection',
                        type: 'POST',
                        dataType: 'JSON',
                        data: { "likeType": "recommend", "recomNum": recomNum },
                        success: function (res) {
                            console.log("yes", JSON.stringify(res));

                        },
                        error: function (res) {
                            console.log("å¤±æ•—", JSON.stringify(res));
                        }
                    });
                };
                //é»æ”¶è—å¾Œæ”¹è®Šå±¬æ€§
                function collection() {
                    document.getElementById("delColle").style.display = "inline";
                    document.getElementById("unLogIn").style.display = "none";
                    document.getElementById("addColle").style.display = "none";
                }
                //å–æ¶ˆæ”¶è—å¾Œæ”¹è®Šå±¬æ€§
                function cancelCollection() {
                    document.getElementById("addColle").style.display = "inline";
                    document.getElementById("unLogIn").style.display = "none";
                    document.getElementById("delColle").style.display = "none";
                }
        </script>

    <!-- æ¨è–¦æ–‡ç« æ„›å¿ƒ ajax script -->
    <script>
        //æ–°å¢æ„›å¿ƒ
        function addLike(recomNum) {
            $.ajax({
                url: '/addLike',
                type: 'POST',
                dataType: 'text',
                data: { "likeType": "recommend", "recomNum": recomNum },
                success: function (res) {
                    console.log("yes", JSON.stringify(res));
                    likeCount(recomNum);
                    like();
                },
                error: function (res) {
                    console.log("å¤±æ•—", res);

                }
            });

        };
        //åˆªé™¤æ„›å¿ƒ
        function delLike(recomNum) {
            // console.log("å‰ç«¯åˆªé™¤è¨Šæ¯");     
            $.ajax({
                url: '/delLike',
                type: 'POST',
                dataType: 'text',
                data: { "likeType": "recommend", "recomNum": recomNum },
                success: function (res) {
                    console.log("yes", JSON.stringify(res));
                    likeCount(recomNum);
                    cancelLike();
                },
                error: function (res) {
                    console.log("åˆªé™¤å¤±æ•—", JSON.stringify(res));
                }
            });

        };
        //é»æ„›å¿ƒå¾Œæ”¹è®Šå±¬æ€§
        function like() {
            document.getElementById("delLike").style.display = "inline";
            document.getElementById("LikeUnLogIn").style.display = "none";
            document.getElementById("addLike").style.display = "none";
        }
        //å–æ¶ˆæ„›å¿ƒå¾Œæ”¹è®Šå±¬æ€§
        function cancelLike() {
            document.getElementById("addLike").style.display = "inline";
            document.getElementById("LikeUnLogIn").style.display = "none";
            document.getElementById("delLike").style.display = "none";
        }
        function likeCount(recomNum) {
            $.ajax({
                url: '/likeCount',
                type: 'POST',
                dataType: 'JSON',
                data: { "likeType": "recommend", "recomNum": recomNum },
                success: function (res) {
                    // console.log("yes", reponse.responseText);
                    console.log("yes", JSON.stringify(res));
                    document.getElementById("addLikeCount").innerHTML = JSON.stringify(res);
                    document.getElementById("delLikeCount").innerHTML = JSON.stringify(res);
                },
                error: function (res) {
                    console.log("no", JSON.stringify(res));
                }

            });
        }
        // =========================
        // ------ ç•™è¨€æ–°å¢æ„›å¿ƒ ------
        // =========================
        //å¢åŠ ç•™è¨€æ„›å¿ƒ
        function MessAddLike(recomNum, recomMessNum) {
            $.ajax({
                url: '/addLike',
                type: 'POST',
                dataType: 'JSON',
                data: { "likeType": "recommendMess", "recomMessNum": recomMessNum, "recomNum": recomNum },
                success: function (res) {
                    console.log("yes", JSON.stringify(res));
                    MessLikeCount(res.recomNum, res.recomMessNum);
                    MessLike(res.recomNum, res.recomMessNum);
                },
                error: function (res) {
                    console.log("å¤±æ•—", res);

                }
            });

        };
        //åˆªé™¤ç•™è¨€æ„›å¿ƒ
        function MessDelLike(recomNum, recomMessNum) {
            // console.log("å‰ç«¯åˆªé™¤è¨Šæ¯");     
            $.ajax({
                url: '/delLike',
                type: 'POST',
                dataType: 'JSON',
                data: { "likeType": "recommendMess", "recomMessNum": recomMessNum, "recomNum": recomNum },
                success: function (res) {
                    console.log("yes", JSON.stringify(res));
                    MessLikeCount(res.recomNum, res.recomMessNum);
                    cancelMessLike(res.recomNum, res.recomMessNum);
                },
                error: function (res) {
                    console.log("åˆªé™¤å¤±æ•—", JSON.stringify(res));
                }
            });

        };
        //é»ç•™è¨€æ„›å¿ƒå¾Œæ”¹è®Šå±¬æ€§
        function MessLike(recomNum, recomMessNum) {
            document.getElementById("MessDelLike" + recomNum + recomMessNum).style.display = "inline";
            document.getElementById("MessLikeUnLogIn" + recomNum + recomMessNum).style.display = "none";
            document.getElementById("MessAddLike" + recomNum + recomMessNum).style.display = "none";
        }
        //å–æ¶ˆç•™è¨€æ„›å¿ƒå¾Œæ”¹è®Šå±¬æ€§
        function cancelMessLike(recomNum, recomMessNum) {
            document.getElementById("MessAddLike" + recomNum + recomMessNum).style.display = "inline";
            document.getElementById("MessLikeUnLogIn" + recomNum + recomMessNum).style.display = "none";
            document.getElementById("MessDelLike" + recomNum + recomMessNum).style.display = "none";
        }
        //å–å¾—ç•™è¨€æ„›å¿ƒæ•¸
        function MessLikeCount(recomNum, recomMessNum) {
            $.ajax({
                url: '/likeCount',
                type: 'POST',
                dataType: 'JSON',
                data: { "likeType": "recommendMess", "recomMessNum": recomMessNum, "recomNum": recomNum },
                success: function (res) {
                    // console.log("yes", reponse.responseText);
                    console.log("yes", JSON.stringify(res));
                    document.getElementById("MessAddLikeCount" + res.recomNum + res.recomMessNum).innerHTML = res.data;
                    document.getElementById("MessDelLikeCount" + res.recomNum + res.recomMessNum).innerHTML = res.data;
                },
                error: function (res) {
                    console.log("no", JSON.stringify(res));
                }
            });
        }
         // delReply
         function deleteReply(artiMessNum, memID) {
                console.log(artiMessNum, memID)
                $('.spinner-border').css('display', 'block')
                $.ajax({
                url: '/addLike',
                type: 'POST',
                data: { "RecomMessNum": artiMessNum, "memID": memID, "deleteRecommendReply": true },
                success: function (res) {
                    // console.log("yes", reponse.responseText);
                    location.reload();
                },
                error: function (res) {
                    console.log('åˆªé™¤å¤±æ•—');
                }
            });
            }
    </script>
    <script>
            //æ¨è–¦ç•™è¨€æª¢èˆ‰ajax
            function ftn_messReport(a){
                $.ajax({
                    url: "/report",
                    type: 'POST',
                    dataType: 'TEXT',
                    data: { "recomMessNum" : a , "reportReason" : $("#messReportReason").val()},
                    success: function (res) {
                        alert(res);
                        location.reload();
                    },
                    error: function (res) {
                        console.log("å¤±æ•—", res);
                    }
                }); 

            }
            </script>
        

</body>

</html>